<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Banco de Pruebas V1.1</title>

<!-- Estilos CSS -->
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 30px;
    }

    h1 {
      text-align: center;
      color: #90caf9;
    }

    form {
      max-width: 900px;
      margin: 0 auto;
      background-color: #1e1e1e;
      padding: 20px 30px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.5);
    }

    label {
      display: inline-block;
      width: 160px;
      margin-bottom: 6px;
    }

    input[type="text"],
    input[type="number"],
    select {
      width: 130px;
      padding: 5px;
      margin-bottom: 10px;
      background-color: #2c2c2c;
      color: #f5f5f5;
      border: 1px solid #555;
      border-radius: 5px;
    }

    input[type="submit"],
    button {
      padding: 8px 25px;
      margin: 8px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
    }

    input[type="submit"] { background-color: #64b5f6; color: black; }
    #start { background-color: #43a047; }
    #stop { background-color: #e53935; }
    .btn-tare { background-color: #00897b; color:white; }
    .btn-calibrate { background-color: #7b1fa2; color:white; }

    #upload {
      background-color: #64b5f6;
      color: black;
    }

    hr {
      border: none;
      border-top: 1px solid #333;
      margin: 15px 0;
    }

    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .checkbox-group label {
      width: auto;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    input[type="checkbox"] {
      accent-color: #64b5f6;
      transform: scale(1.2);
      cursor: pointer;
    }

    .loadcell-row {
      display: flex;
      justify-content: space-between;
      gap: 20px;
      margin-top: 10px;
    }

    .loadcell-group {
      flex: 1;
      background-color: #2a2a2a;
      padding: 10px 15px;
      border-radius: 8px;
      text-align: center;
    }

    .loadcell-group h4 {
      margin-bottom: 8px;
      color: #90caf9;
    }
  </style>
</head>

<!-- Cuerpo -->
<body>

  <h1>Banco de Pruebas V1.1</h1>

  <!-- Formulario -->
  <form method="POST" id="testForm">

    <h2>Parámetros de la hélice</h2>
    <div style="display:inline-block; width:48%;">
      <label>Modelo:</label> <input type="text" name="propName"><br>
      <label>Diámetro (in):</label> <input type="number" name="diameter" step="1" min="0"><br>
    </div>
    <div style="display:inline-block; width:48%;">
      <label>Paso (in):</label> <input type="number" name="pitch" step="1" min="0"><br>
    </div>

    <hr>

    <h2>Parámetros del motor</h2>
    <div style="display:inline-block; width:48%;">
      <label>Modelo:</label> <input type="text" name="motorName"><br>
      <label>KV:</label> <input type="number" name="kv" step="50" min="0"><br>
    </div>
    <div style="display:inline-block; width:48%;">
      <label>Voltaje (V):</label> <input type="number" name="voltage" step="any" min="0"><br>
      <label>Corriente máx (A):</label> <input type="number" name="maxCurrent" step="any" min="0"><br>
    </div>

    <hr>

    <h2>Parámetros del ensayo</h2>
    <div style="display:inline-block; width:48%;">
      <label>Nombre del ensayo:</label>
      <input type="text" name="testName" placeholder="Ej: Ensayo_01"><br>
      <label>Vel. inicio (%):</label> <input type="number" name="vel_init" step="1" min="0"><br>
      <label>Vel. fin (%):</label> <input type="number" name="vel_last" step="1" min="0"><br>
    </div>

    <div style="display:inline-block; width:48%;">
      <label>Duración paso (s):</label> <input type="number" name="stepTime" step="any" min="0.1"><br>
      <label>N° pasos:</label> <input type="number" name="step" step="1" min="1"><br>
      <label>N° vueltas:</label> <input type="number" name="cicles" step="1" min="1"><br>
    </div>

    <h4>Variables a medir:</h4>
    <div class="checkbox-group">
      <label><input type="checkbox" name="measure_rpm"> RPM</label>
      <label><input type="checkbox" name="measure_thrust"> Empuje</label>
      <label><input type="checkbox" name="measure_torque"> Par</label>
      <label><input type="checkbox" name="measure_current"> Corriente</label>
    </div>

    <div class="loadcell-row">
      <div class="loadcell-group">
        <h4>Celda de carga Empuje</h4>
        <button type="button" class="btn-tare" onclick="sendAction('tare1')">Tarar</button>
        <button type="button" class="btn-calibrate" onclick="sendAction('calibrate1')">Calibrar</button>
      </div>
      <div class="loadcell-group">
        <h4>Celda de carga Par</h4>
        <button type="button" class="btn-tare" onclick="sendAction('tare2')">Tarar</button>
        <button type="button" class="btn-calibrate" onclick="sendAction('calibrate2')">Calibrar</button>
      </div>
    </div>

    <hr>

<div class="loadcell-row">
  <div class="loadcell-group">
    <button type="button" id="start" onclick="submitForm()">Iniciar Ensayo</button>
    <button type="button" id="stop" onclick="sendAction('stop')">Detener Ensayo</button>
  </div>
</div>


  </form>

<!-- Scripts JS para enviar datos s backend-->
<script>
  function sendAction(action) {
    fetch('/', {
      method: 'POST',
      headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
      body: 'action=' + encodeURIComponent(action)
    });
  }

  function submitForm() {
    const form = document.getElementById('testForm');
    const formData = new FormData(form);
    formData.append('action', 'start');
    fetch('/', {
      method: 'POST',
      body: new URLSearchParams(formData)
    });
  }
</script>
</body>
</html>